#Switching to right folder
cd /d "D:\00. Files\1. WIP\2. Data Analysis\MadewithML\MLOps"

#Activating venv
venv\Scripts\activate

#Launching training
from config import config
from classifyops import main
from pathlib import Path
args_fp = Path(config.CONFIG_DIR, "args.json")
main.train_model(args_fp)

#Launching optimization
from config import config
from classifyops import main
from pathlib import Path
args_fp = Path(config.CONFIG_DIR, "args.json")
main.optimize(args_fp, study_name="optimization", num_trials=100)

#Experiment tracking

from config import config
from classifyops import main
from pathlib import Path
args_fp = Path(config.CONFIG_DIR, "args.json")
main.train_model(args_fp, experiment_name="baselines", run_name="sgd")

#Predicting sample text
from config import config
from classifyops import main
text = "Transfer learning with transformers to classify tags from text data."
from pathlib import Path
run_id = open(Path(config.CONFIG_DIR, "run_id.txt")).read()
main.predict_tag(text=text, run_id=run_id)

#Publishing docs
mkdocs gh-deploy